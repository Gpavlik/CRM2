<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>üî¨ –¶–µ–Ω—Ç—Ä –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ñ–≤ —Ä–µ–∞–≥–µ–Ω—Ç—ñ–≤</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f0f4f8; }
    h1 { text-align: center; }
    .device-card {
      background: #fff; padding: 15px; margin: 10px 0; border-left: 5px solid #0077cc;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .device-card h2 { margin: 0; }
    .device-card p { margin: 5px 0 10px; color: #555; }
    .device-card a {
      display: inline-block; padding: 8px 12px; background: #0077cc; color: #fff;
      text-decoration: none; border-radius: 4px;
    }
    body { font-family: Arial, sans-serif; margin: 40px; }
    .login-box { max-width: 300px; margin: auto; padding: 20px; border: 1px solid #ccc; }
    input { width: 100%; padding: 8px; margin: 8px 0; }
    button { width: 100%; padding: 10px; }
    .result { margin-top: 20px; }
    pre { background: #f4f4f4; padding: 10px; }
  </style>
  <!--<script src="https://www.google.com/recaptcha/api.js" async defer></script>-->


</head>
<body>
<form id="accessForm" onsubmit="return validateCaptcha()">
  <div class="g-recaptcha" data-sitekey="YOUR_SITE_KEY_HERE"></div>
  <button type="submit">–£–≤—ñ–π—Ç–∏</button>
</form>


  <div id="mainMenu" style="display:none;">
  <h2>üë§ –ú—ñ–π –¥–æ—Å—Ç—É–ø</h2>
  <ul>
    <li><a href="./labcards/index.html">üß™ –ú–æ—ó –ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—ó</a></li>
    <li><a href="./calendar/calendar.html">üìÖ –ú—ñ–π –∫–∞–ª–µ–Ω–¥–∞—Ä</a></li>
    <li><a href="./reports/index.html">üìä –ú–æ—ó –∑–≤—ñ—Ç–∏</a></li>
  </ul>
</div>


  <div class="login-box">
    <h2>–í—Ö—ñ–¥ —É —Å–∏—Å—Ç–µ–º—É</h2>
    <input type="text" id="login" placeholder="–õ–æ–≥—ñ–Ω">
    <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å">
    <button onclick="authenticate()">–£–≤—ñ–π—Ç–∏</button>
    <button onclick="loadPartners()">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–∞—Ä—Ç–Ω–µ—Ä—ñ–≤</button>
    <button onclick="logout()">–í–∏–π—Ç–∏</button>
    <div class="result" id="result"></div>
  </div>

  <script>
    async function authenticate() {
      const login = document.getElementById("login").value;
      const password = document.getElementById("password").value;

      const response = await fetch("/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ login, password })
      });

      const result = await response.json();
      if (response.status !== 200) {
        document.getElementById("result").innerHTML = `<p style='color:red'>‚ùå ${result.error}</p>`;
        return;
      }

      document.getElementById("result").innerHTML =
        `<p>‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞. –í–∏ —É–≤—ñ–π—à–ª–∏ —è–∫ <b>${result.role}</b> (${result.territory}).</p>`;
    }

    async function loadPartners() {
      const response = await fetch("/partners");
      const result = await response.json();
      if (response.status !== 200) {
        document.getElementById("result").innerHTML = `<p style='color:red'>‚ùå ${result.error}</p>`;
        return;
      }
      document.getElementById("result").innerHTML =
        `<p>üìä –î–æ—Å—Ç—É–ø–Ω–æ ${result.partners.length} –ø–∞—Ä—Ç–Ω–µ—Ä—ñ–≤:</p>
         <pre>${JSON.stringify(result.partners, null, 2)}</pre>`;
    }

    async function logout() {
      const response = await fetch("/logout", { method: "POST" });
      const result = await response.json();
      document.getElementById("result").innerHTML = `<p>üö™ ${result.message}</p>`;
    }
  </script>
</body>
</html>
